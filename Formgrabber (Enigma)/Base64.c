#include <Windows.h>

int ToBase64Crypto( const BYTE* pSrc, int nLenSrc, wchar_t* pDst, int nLenDst )
{
   DWORD nLenOut= nLenDst;
   BOOL fRet= CryptBinaryToStringW((const BYTE*)pSrc, nLenSrc,CRYPT_STRING_BASE64 | CRYPT_STRING_NOCRLF,pDst, &nLenOut);
   if (!fRet) nLenOut=0;
   return( nLenOut );
}

int ToBase64CryptoA( const BYTE* pSrc, int nLenSrc, char* pDst, int nLenDst )
{
   DWORD nLenOut= nLenDst;
   BOOL fRet= CryptBinaryToStringA((const BYTE*)pSrc, nLenSrc,CRYPT_STRING_BASE64 | CRYPT_STRING_NOCRLF,pDst, &nLenOut);
   if (!fRet) nLenOut=0;
   return( nLenOut );
}

int FromBase64CryptoA( const BYTE* pSrc, int nLenSrc, char* pDst, int nLenDst )
{
   DWORD nLenOut= nLenDst;
   BOOL fRet= CryptStringToBinaryA((LPCSTR)pSrc, nLenSrc,CRYPT_STRING_BASE64,(BYTE*)pDst, &nLenOut,NULL,NULL);
   if (!fRet) nLenOut=0;  
   return( nLenOut );
}


int FromBase64Crypto( const BYTE* pSrc, int nLenSrc, wchar_t* pDst, int nLenDst )
{
   DWORD nLenOut= nLenDst;
   BOOL fRet= CryptStringToBinaryW((LPCWSTR)pSrc, nLenSrc,CRYPT_STRING_BASE64,(BYTE*)pDst, &nLenOut,NULL,NULL);
   if (!fRet) nLenOut=0;  
   return( nLenOut );
}
