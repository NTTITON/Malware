#ifndef NTDLL_H_
#define NTDLL_H_


#define NT_SUCCESS(Status) ((NTSTATUS)(Status) >= 0)

typedef struct _LSA_UNICODE_STRING {
	USHORT Length;
	USHORT MaximumLength;
	PWSTR  Buffer;
} UNICODE_STRING, *PUNICODE_STRING;

typedef struct _OBJECT_ATTRIBUTES {
	ULONG           Length;
	HANDLE          RootDirectory;
	PUNICODE_STRING ObjectName;
	ULONG           Attributes;
	PVOID           SecurityDescriptor;
	PVOID           SecurityQualityOfService;
}  OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;

typedef NTSTATUS (WINAPI* NtCreateSection_)( _Out_     PHANDLE SectionHandle,
  _In_      ACCESS_MASK DesiredAccess,
  _In_opt_  POBJECT_ATTRIBUTES ObjectAttributes,
  _In_opt_  PLARGE_INTEGER MaximumSize,
  _In_      ULONG SectionPageProtection,
  _In_      ULONG AllocationAttributes,
  _In_opt_  HANDLE FileHandle
);

typedef NTSTATUS (WINAPI* NtMapViewOfSection_)(
  _In_         HANDLE SectionHandle,
  _In_         HANDLE ProcessHandle,
  _Inout_      PVOID *BaseAddress,
  _In_         ULONG_PTR ZeroBits,
  _In_         SIZE_T CommitSize,
  _Inout_opt_  PLARGE_INTEGER SectionOffset,
  _Inout_      PSIZE_T ViewSize,
  _In_         DWORD InheritDisposition,
  _In_         ULONG AllocationType,
  _In_         ULONG Win32Protect
);


typedef NTSTATUS (WINAPI* NtUnmapViewOfSection_)(  _In_      HANDLE ProcessHandle,
  _In_opt_  PVOID BaseAddress);


typedef NTSTATUS (WINAPI* NtClose_)(HANDLE Handle);


#endif