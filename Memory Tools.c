#include <Windows.h>


BOOL CompareMemoryWithMask(unsigned char* ucSignature, DWORD dwAddress,DWORD dwSig)
{
	for (; dwSig > 0; --dwSig, ++ucSignature, ++dwAddress)
	{
		if (*ucSignature != '?' && *ucSignature != *(unsigned char*)dwAddress)
			return FALSE;
	}
	return TRUE;
}

DWORD FindMemory(unsigned char* ucSignature, DWORD dwModuleBase, DWORD dwModuleSize,DWORD dwSig)
{
	DWORD i = 0;
	for (i = 0; i < dwModuleSize; i++)
	{
		if (CompareMemoryWithMask(ucSignature,dwModuleBase+i,dwSig))
		{
			return dwModuleBase+i;
		}
	}
	return 0;
}

